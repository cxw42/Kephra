Because measuring text is slow, Scintilla avoids doing this as much
as possible. If you want to find the width of the widest line, ensure
the document is all styled (SCI_COLOURISE) then call
SCI_POINTXFROMPOSITION on the last position of each line. 

Ã

use Encode;
sub AppendText {
    my ($self, $text) = @_;
    my $string = decode("utf8", $text);
    $self->SUPER::AppendText($string);
}
  my $string = utf8::is_utf8($text) ? $text : decode('utf8', $text); 